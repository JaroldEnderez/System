import React, { Component } from "react";
import css from "./Links.module.css";

const list = [
  { id: 0, text: "End-to-start" },
  { id: 1, text: "Start-to-start" },
  { id: 2, text: "End-to-end" },
  { id: 3, text: "Start-to-end" },
];

export default class Links extends Component {
  onClick(e) {
    const { action, id } = e.target.dataset;
    if (action) {
      this.props.action({ action, id });
    }
  }

  onSelect(e) {
    const id = e.target.dataset.id;
    const value = e.target.value * 1;
    this.props.action({ action: "update-link", id, obj: { type: value } });
  }

  render() {
    const { linksData } = this.props;
    return (
      <>
        {linksData.map((links) => {
          if (links.data.length)
            return (
              <div key={links.title} className={css.links}>
                <p className={css.label}>{links.title}</p>
                <table className={css.table} onClick={(e) => this.onClick(e)}>
                  <tbody>
                    {links.data.map((obj, i) => (
                      <tr key={i} className={css.row}>
                        <td className={css.cell}>
                          <div className={css.taskName}>
                            {obj.task.text ||
                              obj.task.textRight ||
                              obj.task.textLeft}
                          </div>
                        </td>

                        <td className={css.cell}>
                          <div className={css.wrapper}>
                            <select
                              className={css.select}
                              value={obj.link.type}
                              onChange={(e) => this.onSelect(e)}
                              data-id={obj.link.id}
                            >
                              {list.map((item) => (
                                <option key={item.id} value={item.id}>
                                  {item.text}
                                </option>
                              ))}
                            </select>
                            <div className={css.iconMore} />
                          </div>
                        </td>

                        <td className={css.cell}>
                          <div
                            className={css.iconDelete}
                            data-action="delete-link"
                            data-id={obj.link.id}
                          ></div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            );
        })}
      </>
    );
  }
}
